name: Integration Workflow

on:
  workflow_dispatch:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  Build:
    runs-on: ubuntu-latest
    steps:
      - name: Setup Cache & Dependencies
        uses: cristovamsilva/python-dependencies-action@master
        with:
          dependencies-directory: src
          application: true
          quality: true
          security: true
          test: true

  # Test:
  #   needs: [Build]
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Test with Pytest
  #       uses: cristovamsilva/pytest-action@main
  #       with:
  #         dependencies-directory: src
  #         tests-directory: src
  #         package-directory: .

  Verify:
  needs: [Build]
  uses: CristovamSilva/gha-workflows/.github/workflows/reusable-integration.yml@main
  with:
    dependencies-directory: src
    source-directory: src
    package-directory: .

    enable-security: true
    security-bandit: true
    security-dependencies-review: false

    enable-quality: true
    quality-sort: true
    quality-format: true
    quality-mypy: true
    quality-flake8: true
    quality-pylint: true

    enable-sonar: false
    # execution-report:
    # coverage-report:
